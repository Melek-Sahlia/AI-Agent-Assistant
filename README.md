# Ketrone - AI Assistant

Ketrone is an AI-powered assistant built with Langchain, LangGraph, and Google's Gemini model. It can understand natural language prompts, use tools like Google Search and Gmail (read/send emails), and interact with users through a web interface.

## Features

*   **Natural Language Understanding:** Powered by Google's Gemini model.
*   **Tool Usage:** 
    *   Google Custom Search for web information.
    *   Web Browser for scraping website content.
    *   Gmail API integration for reading and sending emails.
*   **Conversational Memory:** Maintains context throughout a session.
*   **Web Interface:** Built with Flask, allowing for interactive chat.
*   **Modular Design:** Tools and agent logic are separated for clarity and extensibility.

## Project Structure

```
. (project_root)
├── agent/
│   └── graph.py          # LangGraph agent definition, state, and logic
├── app/
│   ├── static/
│   │   ├── script.js     # Frontend JavaScript for chat interaction
│   │   ├── style.css     # CSS for the web interface
│   │   └── logo.png      # Application logo
│   ├── templates/
│   │   └── index.html    # Main HTML template for the chat UI
│   └── app.py            # Flask backend application
├── tools/
│   ├── search.py         # Google Custom Search tool
│   ├── browser.py        # Web browsing/scraping tool
│   └── gmail.py          # Gmail API integration (read/send)
├── .env.example          # Example environment variables file
├── .gitignore            # Specifies intentionally untracked files
├── credentials.json      # (To be obtained by user) Gmail API credentials
├── main.py               # Original CLI entry point (can be used for testing)
├── README.md             # This file
├── requirements.txt      # Python dependencies
└── token.json            # (Generated by Gmail auth) Gmail API token
```

## Prerequisites

*   Python 3.9+ and `pip`.
*   Google Cloud Project with:
    *   Generative Language API (for Gemini) enabled.
    *   Custom Search API enabled.
    *   Gmail API enabled.
*   An API Key for the Generative Language API.
*   A Custom Search Engine ID and your Google API Key (can be the same as above if configured for search).
*   OAuth 2.0 Client ID credentials (downloaded as `credentials.json`) for the Gmail API.

## Setup Instructions

1.  **Clone the Repository:**
    ```bash
    git clone https://github.com/Melek-Sahlia/AI-Agent-Assistant.git
    cd AI-Agent-Assistant
    ```

2.  **Create and Activate a Virtual Environment:**
    ```bash
    python -m venv venv
    # On Windows
    .\venv\Scripts\activate
    # On macOS/Linux
    source venv/bin/activate
    ```

3.  **Install Dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Set Up Environment Variables:**
    *   Copy `.env.example` to a new file named `.env`:
        ```bash
        # On Windows (Command Prompt)
        copy .env.example .env
        # On Windows (PowerShell)
        Copy-Item .env.example .env
        # On macOS/Linux
        cp .env.example .env
        ```
    *   Edit the `.env` file and fill in your actual API keys and IDs:
        *   `GOOGLE_API_KEY`: Your Gemini API key.
        *   `GOOGLE_CSE_ID`: Your Google Custom Search Engine ID.
        *   `GMAIL_CREDENTIALS_FILE`: Should remain `"credentials.json"` if you place the file in the root.
        *   `GMAIL_TOKEN_FILE`: Should remain `"token.json"`.

5.  **Obtain Gmail API Credentials:**
    *   Go to the [Google Cloud Console](https://console.cloud.google.com/).
    *   Navigate to "APIs & Services" > "Credentials".
    *   Create an "OAuth 2.0 Client ID". Select "Desktop app" as the application type.
    *   Download the JSON file. Rename it to `credentials.json` and place it in the root directory of the project. **Important:** This file contains sensitive information and should *not* be committed to version control (it is included in `.gitignore`).
    *   Ensure the Gmail API is enabled for your project and that you've configured the OAuth consent screen, adding the necessary scopes (`https://www.googleapis.com/auth/gmail.readonly`, `https://www.googleapis.com/auth/gmail.send`) and your test user.

## Running the Application

1.  **Ensure your virtual environment is activated.**
2.  **Navigate to the project root directory.**
3.  **Run the Flask application:**
    ```bash
    python app/app.py
    ```
4.  Open your web browser and go to `http://127.0.0.1:5001` (or the address shown in the terminal).

5.  **Gmail Authentication (First Run):**
    *   When you first try to use a Gmail-related feature (like reading an email), the application will open a new tab in your browser for Google authentication.
    *   Follow the prompts to authorize the application to access your Gmail account.
    *   After successful authentication, a `token.json` file will be created in the project root, storing your access and refresh tokens for future sessions.

## How It Works

*   **Frontend (`app/static/`, `app/templates/`):** A simple HTML, CSS, and JavaScript interface allows users to send messages.
*   **Backend (`app/app.py`):** A Flask server handles:
    *   Serving the web interface.
    *   Receiving user messages via the `/chat` endpoint.
    *   Managing conversation history.
    *   Interacting with the LangGraph agent.
    *   Handling Gmail OAuth flow for token generation/refresh.
*   **Agent (`agent/graph.py`):** 
    *   Defines the core conversational agent using LangGraph.
    *   `AgentState` manages the list of messages.
    *   The graph orchestrates calls to the Gemini LLM and the defined tools based on the LLM's decisions.
    *   The LLM is bound with the available tools, allowing it to decide when and how to use them.
*   **Tools (`tools/`):**
    *   Each tool (`search.py`, `browser.py`, `gmail.py`) is a self-contained module providing specific functionality (e.g., web search, email access).
    *   They are wrapped as Langchain `Tool` or `StructuredTool` objects, making them compatible with the LangGraph agent.
    *   `gmail.py` also handles the OAuth 2.0 authentication flow to obtain and refresh API tokens.

## CLI (Optional)

The `main.py` file provides a command-line interface for interacting with the agent. This was used for initial development and can still be used for testing the agent logic directly:
```bash
python main.py
```

This README should now provide a good starting point for anyone wanting to run or understand the project. You can add more specific details or troubleshooting tips as needed. 
